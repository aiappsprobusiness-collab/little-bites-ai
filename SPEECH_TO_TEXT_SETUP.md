# Настройка распознавания речи через Whisper API

## Что изменилось

Вместо встроенного Web Speech API (который требует доступ к серверам Google) теперь используется **Whisper API от OpenAI** через Supabase Edge Function. Это решение:
- ✅ Работает без VPN
- ✅ Не зависит от доступа к Google
- ✅ Более точное распознавание речи
- ✅ Поддержка русского языка

## Настройка

### Шаг 1: Получите OpenAI API ключ

1. Перейдите на https://platform.openai.com/api-keys
2. Войдите или зарегистрируйтесь
3. Создайте новый API ключ
4. Скопируйте ключ (он начинается с `sk-`)

### Шаг 2: Добавьте ключ в Supabase

1. Откройте Supabase Dashboard: https://supabase.com/dashboard
2. Выберите ваш проект
3. Перейдите в **Settings** → **Edge Functions** → **Secrets**
4. Добавьте новый секрет:
   - **Name**: `OPENAI_API_KEY`
   - **Value**: ваш OpenAI API ключ (начинается с `sk-`)
5. Нажмите **Save**

### Шаг 3: Деплой Edge Function

Выполните в терминале:

```bash
cd c:\Projects\little-bites-ai
npx supabase functions deploy speech-to-text
```

Или если вы используете Supabase CLI локально:

```bash
supabase functions deploy speech-to-text
```

## Использование

1. Откройте чат в приложении
2. Нажмите кнопку с иконкой микрофона
3. Говорите - запись начнется автоматически
4. Нажмите микрофон еще раз, чтобы остановить запись
5. Текст будет автоматически распознан и добавлен в поле ввода
6. Отредактируйте текст при необходимости
7. Нажмите "Отправить"

## Важно

- **API ключ хранится в Supabase Secrets** - он не виден в коде клиента
- **Whisper API платный** - проверьте тарифы на https://openai.com/pricing
- Первые $5 бесплатно при регистрации
- Примерная стоимость: ~$0.006 за минуту аудио

## Альтернативы

Если не хотите использовать OpenAI, можно настроить:
- **AssemblyAI** - аналогичный сервис
- **Google Cloud Speech-to-Text** - если есть доступ к Google Cloud

Для этого нужно будет изменить Edge Function `speech-to-text/index.ts`.
