# Решение проблемы "Network Error" в Speech-to-Text

## Проблема

Ошибка: `{error: 'Проблема с сетью. Web Speech API требует интернет-соединение.', code: 'network'}`

**Причина:** Web Speech API требует доступ к серверам Google для распознавания речи. Если доступ к Google заблокирован (например, в некоторых регионах), API не может работать.

## Решения

### ✅ Решение 1: Использовать VPN (быстрое решение)

1. Установите VPN (например, ProtonVPN, NordVPN, или любой другой)
2. Подключитесь к серверу
3. Обновите страницу приложения
4. Попробуйте снова использовать микрофон

### ✅ Решение 2: Ввести текст вручную (всегда работает)

Кнопка микрофона **не обязательна** - вы можете просто ввести текст в поле ввода и нажать "Отправить".

### ✅ Решение 3: Использовать Android приложение (лучшее решение)

Android приложение использует нативное распознавание речи, которое:
- ✅ Работает **полностью офлайн**
- ✅ Не требует интернет-соединение
- ✅ Не зависит от Google серверов
- ✅ Поддерживает русский язык

**Как использовать:**
1. Соберите Android APK: `npm run build:android`
2. Установите на Android устройство
3. Голосовой ввод будет работать офлайн

### ✅ Решение 4: Проверить интернет-соединение

Убедитесь, что:
- Интернет-соединение активно
- Нет блокировки доступа к Google
- Брандмауэр не блокирует соединение

## Что было улучшено в коде

1. ✅ **Улучшены сообщения об ошибках** - теперь они более понятные и предлагают решения
2. ✅ **Приоритет Android Native** - если доступен, используется Android Native (работает офлайн)
3. ✅ **Автоматический fallback** - при network ошибке система пытается использовать Android Native
4. ✅ **Подробные инструкции** - пользователь видит, что делать при ошибке

## Технические детали

### Web Speech API
- **Почти всегда требует доступ к серверам Google** - офлайн режим возможен только в очень узких сценариях (часть Chrome на Android с предзагруженными языковыми пакетами), но поведение нестабильно, особенно для русского языка
- На Android Chrome сильно зависит от установленного сервиса распознавания (Google/производитель)
- При отсутствии или блокировке сервиса часто не работает вообще
- Может быть заблокирован в некоторых регионах
- **Не рекомендуется полагаться на офлайн режим Web Speech API**

### Android Native SpeechRecognizer
- Работает полностью офлайн (не требует интернет-соединение)
- Использует встроенные возможности Android
- **Важно**: Зависит от установленного сервиса распознавания (Google/производитель). При отсутствии или блокировке сервиса может не работать

## Рекомендации

**Для разработки/тестирования:**
- Используйте VPN для доступа к Web Speech API
- Или вводите текст вручную

**Для продакшена:**
- Используйте Android приложение с нативным распознаванием
- Или добавьте интеграцию с Vosk для полностью офлайн режима

## Следующие шаги (опционально)

Если нужно полностью офлайн решение для веб:

1. **Интегрировать Vosk** - офлайн библиотека распознавания речи
2. **Использовать Whisper через Edge Functions** - локальное распознавание
3. **Создать собственный сервис** - используя открытые модели

Но для большинства случаев достаточно:
- Android приложение (офлайн)
- Или VPN для веб-версии
